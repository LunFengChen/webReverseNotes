# 抓包分析

![image-20250806230007357](./assets/image-20250806230007357.png)

https://www.dxy.cn/bbs/newweb/pc/home

打开抓包就有一个检查登录信息的包

![image-20250806230208671](./assets/image-20250806230208671.png)

请求头没啥东西

![image-20250806230222984](./assets/image-20250806230222984.png)

请求体也没啥东西，主要是sign，nonce肯定是随机的

刷新网站

![image-20250806230300852](./assets/image-20250806230300852.png)

接下来去搞定这个sign就行



# sign逆向

跟栈不好找



搜索的话，搜sign也没那么方便，所以我们搜nonceStr

![image-20250807132935891](./assets/image-20250807132935891.png)

然后这里就看js文件就行，第一个

右键，到source中查看

![image-20250807133118869](./assets/image-20250807133118869.png)

第这里就找到了o.sign了（这个js是分发下来的，所以名字啥的会变）

刷新页面

![image-20250807133244492](./assets/image-20250807133244492.png)

这里就是最外层明文了

接下来看s()

![image-20250807161611041](./assets/image-20250807161611041.png)

这里先走了 `a`再走了 `r.wordsToBytes`

我们直接扣代码吧

![image-20250807163644772](./assets/image-20250807163644772.png)

先扣外层的，这里o和s()需要处理

![image-20250807163726055](./assets/image-20250807163726055.png)

代码扣下来

![image-20250807163844358](./assets/image-20250807163844358.png)

缺了 `r.wordsToBytes`和`a`

我们先补a吧

![image-20250807164331470](./assets/image-20250807164331470.png)

![image-20250807164345575](./assets/image-20250807164345575.png)

缺了`o.stringToBytes`

![image-20250807164501992](./assets/image-20250807164501992.png)

![image-20250807164453352](./assets/image-20250807164453352.png)

这个`e.bin.stringToBytes`没有

![image-20250807164641906](./assets/image-20250807164641906.png)

![image-20250807164622055](./assets/image-20250807164622055.png)

接下来是没有 `r.bytesToWords`

![image-20250807164905360](./assets/image-20250807164905360.png)

![image-20250807164848871](./assets/image-20250807164848871.png)

这里a(t)正常打印了，我们与js对比一下

![image-20250807165023687](./assets/image-20250807165023687.png)

一样的，接下来是 `r.wordsToBytes`

![image-20250807165049526](./assets/image-20250807165049526.png)

![image-20250807165202465](./assets/image-20250807165202465.png)

缺 `r.bytesToHex`

![image-20250807170351832](./assets/image-20250807170351832.png)

![image-20250807170331606](./assets/image-20250807170331606.png)

搞定了，对比js看看

![image-20250807170634932](./assets/image-20250807170634932.png)

没啥问题，ok

接下来看明文如何拼接的

![image-20250807171927624](./assets/image-20250807171927624.png)

测试发现`i`的`appSignKey`是不变的

![image-20250807172042089](./assets/image-20250807172042089.png)

python写个调用逻辑就行

搞定了

![image-20250807172231098](./assets/image-20250807172231098.png)

发包看看，这个返回也是正常的，和web段拿到的一样，搞定！